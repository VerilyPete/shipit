<!-- Contact Form Modal -->
<div id="contact-modal" class="modal">
  <div class="modal-overlay" onclick="closeContactModal()"></div>
  <div class="modal-content">
    <div class="modal-header">
      <h2>Get in Touch</h2>
      <button class="modal-close" onclick="closeContactModal()" aria-label="Close modal">&times;</button>
    </div>
    <div class="modal-body">
      <p class="modal-description">I'm always interested in discussing new opportunities and collaborations.</p>
      <form action="{{ .Site.Params.basinEndpoint }}" method="POST" class="contact-form" data-ajax="true">
        <div class="form-group">
          <label for="modal-name">Name *</label>
          <input type="text" id="modal-name" name="name" required placeholder="Your name">
        </div>

        <div class="form-group">
          <label for="modal-email">Email *</label>
          <input type="email" id="modal-email" name="email" required placeholder="your.email@example.com">
        </div>

        <div class="form-group">
          <label for="modal-subject">Subject *</label>
          <input type="text" id="modal-subject" name="subject" required placeholder="What's this about?">
        </div>

        <div class="form-group">
          <label for="modal-message">Message *</label>
          <textarea id="modal-message" name="message" rows="5" required placeholder="Tell me more..."></textarea>
        </div>

        <!-- Honeypot field for spam prevention -->
        <input type="text" name="website" tabindex="-1" autocomplete="off" style="display:none">

        <div class="form-status" data-status></div>

        <button type="submit" class="submit-button">Send Message</button>
      </form>
    </div>
  </div>
</div>

<script>
// Open contact modal when email icon is clicked
document.addEventListener('DOMContentLoaded', function() {
  const emailLinks = document.querySelectorAll('a[href="#contact-modal"]');
  emailLinks.forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      openContactModal();
    });
  });

  // Close modal on Escape key
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      closeContactModal();
    }
  });

  // Wire AJAX for contact forms
  document.querySelectorAll('.contact-form').forEach(function(form){
    form.addEventListener('submit', async function(e){
      if (!form.dataset.ajax) return;
      e.preventDefault();
      const btn = form.querySelector('[type="submit"]');
      const status = form.querySelector('[data-status]');
      btn.disabled = true;
      status.textContent = 'Sendingâ€¦';
      try {
        const res = await fetch(form.action, { method: 'POST', body: new FormData(form), headers: { 'Accept': 'application/json' }});
        if (res.ok) { status.textContent = 'Thanks! Your message was sent.'; form.reset(); }
        else { status.textContent = 'Sorry, something went wrong. Please try again.'; }
      } catch (_) { status.textContent = 'Network error. Please try again.'; }
      btn.disabled = false;
    });
  });
});

function openContactModal() {
  const modal = document.getElementById('contact-modal');
  if (modal) {
    modal.classList.add('modal-open');
    document.body.style.overflow = 'hidden';
  }
}

function closeContactModal() {
  const modal = document.getElementById('contact-modal');
  if (modal) {
    modal.classList.remove('modal-open');
    document.body.style.overflow = '';
  }
}
</script>

